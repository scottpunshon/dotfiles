#!/usr/bin/env python
import sys
# Python2
try:
	import BaseHTTPServer as HTTPServer
	from SimpleHTTPServer import SimpleHTTPRequestHandler as HTTPRequestHandler
# Python3
except ModuleNotFoundError:
	import http.server as HTTPServer
	from http.server import SimpleHTTPRequestHandler as HTTPRequestHandler


def http_server(HandlerClass=HTTPRequestHandler,
                ServerClass=HTTPServer.HTTPServer):
    protocol = 'HTTP/1.1'
    host     = ''
    port     = 8000
    if len(sys.argv) > 1:
        arg = sys.argv[1]
        if ':' in arg:
            host, port = arg.split(':')
            port = int(port)
        else:
            try:
                port = int(arg)
            except:
                host = arg

    server_address = (host, port)

    HandlerClass.protocol_version = protocol
    httpd = ServerClass(server_address, HandlerClass)

    sa = httpd.socket.getsockname()
    print('Serving HTTP on {0} port {1} ...'.format(sa[0], sa[1]))
    httpd.serve_forever()


if __name__ == '__main__':
	try:
		http_server()
	except KeyboardInterrupt:
		sys.exit()

